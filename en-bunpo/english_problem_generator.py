import pandas as pd
import os

def create_english_problems():
    """
    中学1年生レベルの英語並び替え問題を生成してエクセルファイルに保存
    """
    
    # 問題データを定義
    problems = [
        {
            '日本語': '彼女は幸せです',
            '正解': 'She is happy .',
            '単語1': 'She', '意味1': '彼女は', '文法1': '主語',
            '単語2': 'is', '意味2': '〜です', '文法2': 'be動詞',
            '単語3': 'happy', '意味3': '幸せな', '文法3': '形容詞',
            '単語4': '.', '意味4': '文の終わり', '文法4': '句読点'
        },
        {
            '日本語': '私は音楽が好きです',
            '正解': 'I like music .',
            '単語1': 'I', '意味1': '私は', '文法1': '主語',
            '単語2': 'like', '意味2': '好き', '文法2': '動詞',
            '単語3': 'music', '意味3': '音楽', '文法3': '名詞',
            '単語4': '.', '意味4': '文の終わり', '文法4': '句読点'
        },
        {
            '日本語': '彼は医者です',
            '正解': 'He is a doctor .',
            '単語1': 'He', '意味1': '彼は', '文法1': '主語',
            '単語2': 'is', '意味2': '〜です', '文法2': 'be動詞',
            '単語3': 'a', '意味3': 'ひとりの', '文法3': '冠詞',
            '単語4': 'doctor', '意味4': '医者', '文法4': '名詞',
            '単語5': '.', '意味5': '文の終わり', '文法5': '句読点'
        },
        {
            '日本語': '私たちはテニスをします',
            '正解': 'We play tennis .',
            '単語1': 'We', '意味1': '私たちは', '文法1': '主語',
            '単語2': 'play', '意味2': 'する', '文法2': '動詞',
            '単語3': 'tennis', '意味3': 'テニス', '文法3': '名詞',
            '単語4': '.', '意味4': '文の終わり', '文法4': '句読点'
        },
        {
            '日本語': '私は泳ぐことができます',
            '正解': 'I can swim .',
            '単語1': 'I', '意味1': '私は', '文法1': '主語',
            '単語2': 'can', '意味2': 'できる', '文法2': '助動詞',
            '単語3': 'swim', '意味3': '泳ぐ', '文法3': '動詞',
            '単語4': '.', '意味4': '文の終わり', '文法4': '句読点'
        },
        {
            '日本語': 'あなたはテニスをしますか？',
            '正解': 'Do you play tennis ?',
            '単語1': 'Do', '意味1': '〜しますか', '文法1': '助動詞',
            '単語2': 'you', '意味2': 'あなたは', '文法2': '主語',
            '単語3': 'play', '意味3': 'する', '文法3': '動詞',
            '単語4': 'tennis', '意味4': 'テニス', '文法4': '名詞',
            '単語5': '?', '意味5': '疑問符', '文法5': '句読点'
        },
        {
            '日本語': '私は日本に行きたいです',
            '正解': 'I want to go to Japan .',
            '単語1': 'I', '意味1': '私は', '文法1': '主語',
            '単語2': 'want', '意味2': 'したい', '文法2': '動詞',
            '単語3': 'to', '意味3': '〜に', '文法3': '前置詞',
            '単語4': 'go', '意味4': '行く', '文法4': '動詞',
            '単語5': 'to', '意味5': '〜に', '文法5': '前置詞',
            '単語6': 'Japan', '意味6': '日本', '文法6': '名詞',
            '単語7': '.', '意味7': '文の終わり', '文法7': '句読点'
        },
        {
            '日本語': 'これは私の本です',
            '正解': 'This is my book .',
            '単語1': 'This', '意味1': 'これは', '文法1': '主語',
            '単語2': 'is', '意味2': '〜です', '文法2': 'be動詞',
            '単語3': 'my', '意味3': '私の', '文法3': '所有格',
            '単語4': 'book', '意味4': '本', '文法4': '名詞',
            '単語5': '.', '意味5': '文の終わり', '文法5': '句読点'
        },
        {
            '日本語': '彼らは学校にいます',
            '正解': 'They are at school .',
            '単語1': 'They', '意味1': '彼らは', '文法1': '主語',
            '単語2': 'are', '意味2': '〜です', '文法2': 'be動詞',
            '単語3': 'at', '意味3': '〜に', '文法3': '前置詞',
            '単語4': 'school', '意味4': '学校', '文法4': '名詞',
            '単語5': '.', '意味5': '文の終わり', '文法5': '句読点'
        },
        {
            '日本語': '彼女は先生になりたいです',
            '正解': 'She wants to be a teacher .',
            '単語1': 'She', '意味1': '彼女は', '文法1': '主語',
            '単語2': 'wants', '意味2': 'したい', '文法2': '動詞',
            '単語3': 'to', '意味3': '〜に', '文法3': '前置詞',
            '単語4': 'be', '意味4': 'なる', '文法4': '動詞',
            '単語5': 'a', '意味5': 'ひとりの', '文法5': '冠詞',
            '単語6': 'teacher', '意味6': '先生', '文法6': '名詞',
            '単語7': '.', '意味7': '文の終わり', '文法7': '句読点'
        }
    ]
    
    # データフレームを作成
    df = pd.DataFrame(problems)
    
    # エクセルファイルに保存
    filename = 'english_problems.xlsx'
    
    try:
        df.to_excel(filename, index=False, engine='openpyxl')
        print(f"✅ 問題集エクセルファイルを生成しました: {filename}")
        print(f"📊 問題数: {len(problems)}問")
        print(f"📁 保存場所: {os.path.abspath(filename)}")
        
        # ファイル内容の確認
        print("\n📋 生成された問題の一覧:")
        for i, problem in enumerate(problems, 1):
            print(f"{i:2d}. {problem['日本語']} → {problem['正解']}")
            
        print(f"\n🎯 使用方法:")
        print(f"1. 生成された '{filename}' をHTMLページにアップロード")
        print(f"2. 問題を追加したい場合は、このスクリプトのproblems配列に追加して再実行")
        
    except Exception as e:
        print(f"❌ エラーが発生しました: {str(e)}")
        print("💡 'openpyxl'ライブラリをインストールしてください: pip install openpyxl")

def add_custom_problem():
    """
    カスタム問題を追加する関数の例
    """
    print("\n🔧 カスタム問題追加の例:")
    print("""
    新しい問題を追加したい場合は、problems配列に以下の形式で追加してください:
    
    {
        '日本語': '私は学生です',
        '正解': 'I am a student .',
        '単語1': 'I', '意味1': '私は', '文法1': '主語',
        '単語2': 'am', '意味2': '〜です', '文法2': 'be動詞',
        '単語3': 'a', '意味3': 'ひとりの', '文法3': '冠詞',
        '単語4': 'student', '意味4': '学生', '文法4': '名詞',
        '単語5': '.', '意味5': '文の終わり', '文法5': '句読点'
    }
    """)

if __name__ == "__main__":
    print("🚀 英語並び替え問題集エクセルファイル生成ツール")
    print("=" * 50)
    
    # 必要なライブラリのチェック
    try:
        import pandas as pd
        import openpyxl
    except ImportError as e:
        print(f"❌ 必要なライブラリが不足しています: {e}")
        print("💡 以下のコマンドでインストールしてください:")
        print("   pip install pandas openpyxl")
        exit(1)
    
    # 問題集を生成
    create_english_problems()
    
    # カスタム問題追加の説明
    add_custom_problem()
